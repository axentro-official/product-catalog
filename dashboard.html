<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Axentro â€” Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</title>

  <style>
    :root{
      --bg:#ffffff;
      --panel:#ffffff;
      --panel2:#fbfbfd;
      --text:#0f172a;
      --muted:#64748b;
      --stroke:#e6e8ee;
      --shadow: 0 18px 50px rgba(15,23,42,.10);
      --radius:18px;

      --gold1:#D4AF37;
      --gold2:#B8860B;
      --goldSoft: rgba(212,175,55,.18);
      --goldSoft2: rgba(184,134,11,.12);

      --ok:#16a34a;
      --warn:#d97706;
      --bad:#dc2626;

      --sideW: 290px;
      --topH: 68px;
      --safe-b: env(safe-area-inset-bottom, 0px);
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: system-ui, -apple-system, "Segoe UI", Tahoma, Arial;
      color:var(--text);
      background:
        radial-gradient(900px 480px at 10% 10%, var(--goldSoft), transparent 60%),
        radial-gradient(760px 520px at 90% 20%, rgba(15,23,42,.05), transparent 60%),
        linear-gradient(180deg, var(--bg), #f7f8fb);
      -webkit-font-smoothing:antialiased;
      display:flex;
      min-height:100vh;
      overflow:hidden;
    }
    a{color:inherit;text-decoration:none}
    button{ -webkit-tap-highlight-color: transparent; touch-action: manipulation; }

    /* Mobile overlay */
    .mOverlay{
      position:fixed; inset:0;
      background: rgba(15,23,42,.35);
      backdrop-filter: blur(4px);
      display:none;
      z-index:90;
    }
    .mOverlay.show{display:block}

    /* Sidebar */
    .sidebar{
      width:var(--sideW);
      min-width:var(--sideW);
      border-inline-end:1px solid var(--stroke);
      background: linear-gradient(180deg, rgba(255,255,255,.96), rgba(248,250,252,.96));
      box-shadow: 0 18px 50px rgba(15,23,42,.08);
      display:flex;
      flex-direction:column;
      padding:14px;
      gap:12px;
    }

    .brand{
      display:flex; align-items:center; gap:12px;
      padding:10px;
      border:1px solid var(--stroke);
      border-radius:16px;
      background: rgba(255,255,255,.92);
      box-shadow: 0 10px 22px rgba(15,23,42,.06);
    }
    .logo{
      width:44px; height:44px; border-radius:999px; display:grid; place-items:center;
      background: linear-gradient(135deg, rgba(212,175,55,.18), rgba(184,134,11,.12));
      border:1px solid rgba(212,175,55,.35);
      overflow:hidden; padding:6px;
      flex:0 0 auto;
    }
    .logo img{width:100%;height:100%;object-fit:contain;display:block}
    .brandTitle{font-size:14px;font-weight:1000}
    .brandSub{font-size:12px;color:var(--muted);margin-top:2px;font-weight:900}

    .nav{
      display:flex;
      flex-direction:column;
      gap:10px;
    }

    .navBtn{
      width:100%;
      text-align:right;
      padding:12px;
      border-radius:16px;
      border:1px solid var(--stroke);
      background: rgba(255,255,255,.92);
      box-shadow: 0 10px 22px rgba(15,23,42,.06);
      cursor:pointer;
      font-weight:1000;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      transition: transform .15s ease, border-color .15s ease, box-shadow .15s ease;
    }
    .navBtn:hover{
      transform: translateY(-1px);
      border-color: rgba(212,175,55,.55);
      box-shadow: 0 16px 30px rgba(15,23,42,.10);
    }
    .navBtn.active{
      border-color: rgba(212,175,55,.75);
      background: linear-gradient(135deg, rgba(212,175,55,.22), rgba(184,134,11,.18));
    }

    .navLeft{display:flex; flex-direction:column; gap:3px; min-width:0;}
    .navTitle{white-space:nowrap; overflow:hidden; text-overflow:ellipsis;}
    .navHint{font-size:11px;color:var(--muted); font-weight:900; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;}

    .badge{
      padding:6px 10px;
      border-radius:999px;
      border:1px solid rgba(212,175,55,.35);
      background: rgba(255,255,255,.86);
      font-size:11px;
      font-weight:1000;
      flex:0 0 auto;
      white-space:nowrap;
    }
    .bOk{ border-color: rgba(22,163,74,.25); }
    .bWarn{ border-color: rgba(217,119,6,.25); }
    .bBad{ border-color: rgba(220,38,38,.25); }

    .cards{
      display:grid;
      grid-template-columns: 1fr;
      gap:10px;
      margin-top:6px;
    }
    .stat{
      border:1px solid var(--stroke);
      border-radius:16px;
      background: rgba(255,255,255,.92);
      box-shadow: 0 10px 22px rgba(15,23,42,.06);
      padding:12px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
    }
    .stat .k{font-size:12px;color:var(--muted); font-weight:900;}
    .stat .v{font-size:16px;font-weight:1100;}
    .stat .v small{font-size:12px;color:var(--muted);font-weight:900}

    .sideFoot{
      margin-top:auto;
      padding-top:10px;
      border-top:1px solid var(--stroke);
      color:var(--muted);
      font-size:12px;
      text-align:center;
      padding-bottom: calc(6px + var(--safe-b));
    }

    /* Main */
    .main{
      flex:1;
      display:flex;
      flex-direction:column;
      min-width:0;
    }

    .topbar{
      height:var(--topH);
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding:12px 14px;
      border-bottom:1px solid var(--stroke);
      background: linear-gradient(180deg, rgba(255,255,255,.92), rgba(255,255,255,.70));
      backdrop-filter: blur(10px);
      gap:10px;
    }

    .topLeft{display:flex; align-items:center; gap:10px; min-width:0;}
    .burger{
      display:none;
      width:44px; height:44px;
      border-radius:14px;
      border:1px solid var(--stroke);
      background: rgba(255,255,255,.92);
      box-shadow: 0 10px 22px rgba(15,23,42,.06);
      cursor:pointer;
      font-weight:1000;
    }

    .pageTitle{font-weight:1100; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;}
    .pageSub{font-size:12px;color:var(--muted); font-weight:900; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;}

    .topRight{
      display:flex;
      align-items:center;
      gap:10px;
      flex-wrap:wrap;
      justify-content:flex-end;
    }

    .btn{
      padding:10px 12px;
      border-radius:14px;
      border:1px solid var(--stroke);
      background: rgba(255,255,255,.92);
      box-shadow: 0 10px 22px rgba(15,23,42,.06);
      cursor:pointer;
      font-weight:1000;
      display:flex;
      align-items:center;
      gap:8px;
      white-space:nowrap;
    }
    .btn.primary{
      border-color: rgba(212,175,55,.65);
      background: linear-gradient(135deg, rgba(212,175,55,.22), rgba(184,134,11,.18));
    }

    .content{
      padding:14px;
      flex:1;
      min-height:0;
    }

    .frameWrap{
      width:100%;
      height:100%;
      border-radius: var(--radius);
      border:1px solid var(--stroke);
      background: rgba(255,255,255,.90);
      box-shadow: var(--shadow);
      overflow:hidden;
      display:flex;
      flex-direction:column;
      min-height:0;
    }

    .frameBar{
      padding:10px;
      border-bottom:1px solid var(--stroke);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      background: rgba(248,250,252,.96);
      flex-wrap:wrap;
    }
    .framePath{
      font-size:12px;
      color:var(--muted);
      font-weight:900;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
      max-width: 100%;
    }

    iframe{
      width:100%;
      height:100%;
      border:0;
      background:#fff;
      flex:1;
      min-height:0;
    }

    @media (max-width: 980px){
      .burger{display:inline-grid; place-items:center;}
      .sidebar{
        position:fixed;
        top:0; bottom:0;
        inset-inline-start:0;
        z-index:100;
        transform: translateX(110%);
        transition: transform .2s ease;
        max-width: min(var(--sideW), 92vw);
      }
      .sidebar.open{transform: translateX(0);}
    }

    :focus{ outline:3px solid rgba(212,175,55,.25); outline-offset:3px; }
  </style>
</head>

<body>
  <div id="mOverlay" class="mOverlay" tabindex="-1"></div>

  <aside id="sidebar" class="sidebar" aria-label="Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªÙ†Ù‚Ù„">
    <div class="brand">
      <div class="logo">
        <img src="images/bslogo.webp" alt="BS Logo"
          onerror="this.onerror=null;this.style.display='none';this.parentElement.textContent='BS'">
      </div>
      <div style="min-width:0">
        <div class="brandTitle">B.S Medical &amp; Aesthetic</div>
        <div class="brandSub">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… â€” Axentro</div>
      </div>
    </div>

    <nav class="nav" aria-label="Ø§Ù„ØµÙØ­Ø§Øª">
      <button class="navBtn" data-page="index.html" data-title="ÙƒØªØ§Ù„ÙˆØ¬ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª" data-sub="Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø³Ù„Ø© ÙˆØ§Ù„Ø¨Ø­Ø«">
        <span class="navLeft">
          <span class="navTitle">ğŸ›ï¸ ÙƒØªØ§Ù„ÙˆØ¬ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</span>
          <span class="navHint">index.html</span>
        </span>
        <span class="badge" id="badgeProducts">â€”</span>
      </button>

      <button class="navBtn" data-page="order.html" data-title="Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø·Ù„Ø¨" data-sub="Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„ ÙˆØ¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨">
        <span class="navLeft">
          <span class="navTitle">ğŸ§¾ Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø·Ù„Ø¨</span>
          <span class="navHint">order.html</span>
        </span>
        <span class="badge" id="badgeCart">0</span>
      </button>

      <button class="navBtn" data-page="admin-invoice.html" data-title="Ù„ÙˆØ­Ø© Ø§Ù„ÙÙˆØ§ØªÙŠØ±" data-sub="ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©">
        <span class="navLeft">
          <span class="navTitle">ğŸ” Ù„ÙˆØ­Ø© Ø§Ù„ÙÙˆØ§ØªÙŠØ±</span>
          <span class="navHint">admin-invoice.html</span>
        </span>
        <span class="badge" id="badgeAdmin">Ù…ØºÙ„Ù‚</span>
      </button>

      <button class="navBtn" data-page="admin-invoice.html?quote=1" data-title="Ø¹Ø±Ø¶ Ø³Ø¹Ø±" data-sub="Quotation Mode">
        <span class="navLeft">
          <span class="navTitle">ğŸ“„ Ø¹Ø±Ø¶ Ø³Ø¹Ø±</span>
          <span class="navHint">admin-invoice.html?quote=1</span>
        </span>
        <span class="badge">Quote</span>
      </button>
    </nav>

    <section class="cards" aria-label="Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø³Ø±ÙŠØ¹Ø©">
      <div class="stat">
        <div>
          <div class="k">Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø³Ù„Ø©</div>
          <div class="v" id="statCartItems">0</div>
        </div>
        <div class="badge">AX_CART_V1</div>
      </div>

      <div class="stat">
        <div>
          <div class="k">Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª (Ù…Ù† Ø§Ù„ÙƒØ§Ø´)</div>
          <div class="v" id="statProductsCount">â€”</div>
        </div>
        <div class="badge">Cache</div>
      </div>

      <div class="stat">
        <div>
          <div class="k">Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ« Ù„Ù„Ù…Ù†ØªØ¬Ø§Øª</div>
          <div class="v" id="statProductsTs">â€”</div>
        </div>
        <div class="badge">TS</div>
      </div>

      <div class="stat">
        <div>
          <div class="k">Ø­Ø§Ù„Ø© Ø§Ù„Ø£Ø¯Ù…Ù†</div>
          <div class="v" id="statAdmin">â€”</div>
        </div>
        <div class="badge" id="statAdminBadge">BS_ADMIN_OK</div>
      </div>
    </section>

    <div class="sideFoot">
      Axentro â€“ All Rights Reserved 2024 Â©<br>By Ahmed Hamouda
    </div>
  </aside>

  <main class="main">
    <header class="topbar">
      <div class="topLeft">
        <button id="burger" class="burger" aria-label="ÙØªØ­ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©">â˜°</button>
        <div style="min-width:0">
          <div class="pageTitle" id="pageTitle">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</div>
          <div class="pageSub" id="pageSub">Ø§Ø®ØªØ± ØµÙØ­Ø© Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©</div>
        </div>
      </div>

      <div class="topRight">
        <button id="openFull" class="btn" title="ÙØªØ­ Ø§Ù„ØµÙØ­Ø© ÙÙŠ ØªØ¨ÙˆÙŠØ¨ Ù…Ø³ØªÙ‚Ù„ (Ø£ÙØ¶Ù„ Ù„Ù„Ø·Ø¨Ø§Ø¹Ø© Ùˆ PDF)">â¤¢ ÙØªØ­ ÙƒØ§Ù…Ù„</button>
        <button id="reloadFrame" class="btn" title="ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙØ­Ø© Ø¯Ø§Ø®Ù„ Ø§Ù„Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯">â†» ØªØ­Ø¯ÙŠØ«</button>
        <button id="goCatalog" class="btn primary" title="Ø§Ù„Ø°Ù‡Ø§Ø¨ Ù„Ù„ÙƒØªØ§Ù„ÙˆØ¬">ğŸ›ï¸ Ø§Ù„ÙƒØªØ§Ù„ÙˆØ¬</button>
      </div>
    </header>

    <section class="content">
      <div class="frameWrap">
        <div class="frameBar">
          <div class="framePath" id="framePath">â€”</div>
          <div style="display:flex; gap:10px; align-items:center; flex-wrap:wrap;">
            <span class="badge" id="modeBadge">Ø¯Ø§Ø®Ù„ Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬</span>
            <span class="badge" id="quickCart">Ø§Ù„Ø³Ù„Ø©: 0</span>
          </div>
        </div>
        <iframe id="appFrame" src="index.html" title="Axentro App"></iframe>
      </div>
    </section>
  </main>

<script>
  // ---- Storage keys from your project
  const LS_CART = "AX_CART_V1";
  const LS_PROD_CACHE = "AX_PRODUCTS_CACHE_V1";
  const LS_PROD_TS = "AX_PRODUCTS_CACHE_TS_V1";
  const SS_ADMIN_OK = "BS_ADMIN_OK";

  // ---- DOM
  const sidebar = document.getElementById("sidebar");
  const mOverlay = document.getElementById("mOverlay");
  const burger = document.getElementById("burger");

  const appFrame = document.getElementById("appFrame");
  const pageTitle = document.getElementById("pageTitle");
  const pageSub = document.getElementById("pageSub");
  const framePath = document.getElementById("framePath");

  const openFull = document.getElementById("openFull");
  const reloadFrame = document.getElementById("reloadFrame");
  const goCatalog = document.getElementById("goCatalog");

  const badgeCart = document.getElementById("badgeCart");
  const badgeProducts = document.getElementById("badgeProducts");
  const badgeAdmin = document.getElementById("badgeAdmin");

  const statCartItems = document.getElementById("statCartItems");
  const statProductsCount = document.getElementById("statProductsCount");
  const statProductsTs = document.getElementById("statProductsTs");
  const statAdmin = document.getElementById("statAdmin");
  const statAdminBadge = document.getElementById("statAdminBadge");

  const quickCart = document.getElementById("quickCart");
  const modeBadge = document.getElementById("modeBadge");

  function safeJsonParse(raw, fallback){
    try{ return JSON.parse(raw); }catch(e){ return fallback; }
  }

  function fmtTs(ts){
    const n = Number(ts||0);
    if(!n) return "â€”";
    const d = new Date(n);
    return d.toLocaleString("ar-EG", { hour12:true });
  }

  function cartCount(){
    const cart = safeJsonParse(localStorage.getItem(LS_CART) || "[]", []);
    if(!Array.isArray(cart)) return 0;
    return cart.reduce((s,it)=> s + (Number(it?.qty)||0), 0);
  }

  function productsCount(){
    const list = safeJsonParse(localStorage.getItem(LS_PROD_CACHE) || "[]", []);
    return Array.isArray(list) ? list.length : 0;
  }

  function adminState(){
    return sessionStorage.getItem(SS_ADMIN_OK) === "1";
  }

  function setBadge(el, text, kind){
    if(!el) return;
    el.textContent = text;
    el.classList.remove("bOk","bWarn","bBad");
    if(kind) el.classList.add(kind);
  }

  function updateBadges(){
    const c = cartCount();
    badgeCart.textContent = String(c);
    statCartItems.textContent = String(c);
    quickCart.textContent = "Ø§Ù„Ø³Ù„Ø©: " + String(c);

    const pc = productsCount();
    badgeProducts.textContent = pc ? (pc + " Ù…Ù†ØªØ¬") : "â€”";
    statProductsCount.textContent = pc ? String(pc) : "â€”";

    statProductsTs.textContent = fmtTs(localStorage.getItem(LS_PROD_TS));

    const isAdmin = adminState();
    statAdmin.textContent = isAdmin ? "âœ… Ù…Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„" : "ğŸ”’ ØºÙŠØ± Ù…Ø³Ø¬Ù„";
    setBadge(badgeAdmin, isAdmin ? "Ù…ÙØªÙˆØ­" : "Ù…ØºÙ„Ù‚", isAdmin ? "bOk" : "bBad");
    statAdminBadge.style.opacity = isAdmin ? "1" : ".85";
  }

  // Active state
  function setActiveNav(page){
    document.querySelectorAll(".navBtn").forEach(b=>{
      b.classList.toggle("active", b.dataset.page === page);
    });
  }

  // Open page inside iframe
  function openPage(page, title, sub){
    appFrame.src = page;
    pageTitle.textContent = title || "Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…";
    pageSub.textContent = sub || page;
    framePath.textContent = "Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©: " + page;

    setActiveNav(page);

    // Helpful hint for admin printing
    if(page.startsWith("admin-invoice.html")){
      modeBadge.textContent = "ÙŠÙØ¶Ù„ ÙØªØ­ ÙƒØ§Ù…Ù„ Ù„Ù„Ø·Ø¨Ø§Ø¹Ø©/PDF";
    }else{
      modeBadge.textContent = "Ø¯Ø§Ø®Ù„ Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬";
    }

    // Close sidebar on mobile
    if(window.matchMedia("(max-width: 980px)").matches){
      sidebar.classList.remove("open");
      mOverlay.classList.remove("show");
    }
  }

  // Nav events
  document.querySelectorAll(".navBtn").forEach(btn=>{
    btn.addEventListener("click", ()=>{
      const page = btn.dataset.page;
      openPage(page, btn.dataset.title, btn.dataset.sub);
    });
  });

  // Toolbar
  openFull.addEventListener("click", ()=>{
    const src = appFrame.getAttribute("src") || "index.html";
    window.open(src, "_blank");
  });

  reloadFrame.addEventListener("click", ()=>{
    try{ appFrame.contentWindow.location.reload(); }
    catch(e){ appFrame.src = appFrame.src; }
  });

  goCatalog.addEventListener("click", ()=>{
    openPage("index.html", "ÙƒØªØ§Ù„ÙˆØ¬ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª", "Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø³Ù„Ø© ÙˆØ§Ù„Ø¨Ø­Ø«");
  });

  // Mobile sidebar
  function openSidebar(){
    sidebar.classList.add("open");
    mOverlay.classList.add("show");
  }
  function closeSidebar(){
    sidebar.classList.remove("open");
    mOverlay.classList.remove("show");
  }
  burger.addEventListener("click", openSidebar);
  mOverlay.addEventListener("click", closeSidebar);
  document.addEventListener("keydown", (e)=>{
    if(e.key === "Escape") closeSidebar();
  });

  // Keep stats fresh
  updateBadges();
  window.addEventListener("focus", updateBadges);
  window.addEventListener("storage", updateBadges);
  setInterval(updateBadges, 2000);

  // Default open
  openPage("index.html", "ÙƒØªØ§Ù„ÙˆØ¬ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª", "Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø³Ù„Ø© ÙˆØ§Ù„Ø¨Ø­Ø«");
</script>

</body>
</html>
